---
title: "Advanced Macro 2 - Assignment 1"
author: "Unterweger L., Oberbrinkmann S."
date: "`r Sys.Date()`"
output: pdf_document
header-includes:
   - \usepackage{booktabs}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(scipen=4)
```

# Preliminary
We hereby declare that the answers to the given assignment are entirely our own, resulting from our own work effort only. Our team members contributed to the answers of the assignment in the following proportions:\\
\begin{itemize}
  \item Unterweger Lucas: 50%
  \item Oberbrinkmann Sophia: 50%
\end{itemize}

# Question 1: Business cycles stylized facts (4 Points)

We'll start by setting up our coding environment by importing necessary packages.
```{r, include=FALSE}
require(ggplot2)
require(forecast)
require(lmtest)
require(tidyverse)
require(readxl)
require(zoo)
require(mFilter)
```

Now, we can import and clean our data set.
```{r}
ireland <- read_excel("data/Ireland_GDPData.xlsx", sheet = 4)
colnames(ireland) <- c("t","Y","G","C","I")
head(ireland)
GDP <- ts(ireland$Y, start = 1995.0, frequency = 4)
C <- ts(ireland$C, start = 1995.0, frequency = 4)
I <- ts(ireland$I, start = 1995.0, frequency = 4)
G <- ts(ireland$G, start = 1995.0, frequency = 4)
plot(GDP, ylim=c(0,100000), ylab="Mio EUR")
lines(C, col="red3")
lines(I, col="lightblue")
lines(G, col="lightgreen")
legend(x="topleft",
       legend = c("Y","C","I","G"),
       col=c("black", "red3", "lightblue","lightgreen"),
       lty=1)
```
## Sample Statistics
Let's compute the sample means:
```{r}
CdivGDP <- C/GDP
IdivGDP <- I/GDP
GdivGDP <- G/GDP

mean(CdivGDP)
mean(IdivGDP)
mean(GdivGDP)
```
## Detrending
Let's apply the HP filter:

```{r}
plot(hpfilter(log(GDP)))
plot(hpfilter(log(G)))
plot(hpfilter(log(I)))
plot(hpfilter(log(C)))
```

## Business Cycle Stylized Facts

```{r}

trend_G <- hpfilter(log(G))[1]$cycle
trend_C <- hpfilter(log(C))[1]$cycle
trend_I <- hpfilter(log(I))[1]$cycle
trend_GDP <- hpfilter(log(GDP))[1]$cycle

output_table <- data.frame(
  names = c("GDP","I","C","G"),
  standard_deviation = c(sd(trend_GDP),sd(trend_I),sd(trend_C),sd(trend_G)),
  relative_sd = c(sd(trend_GDP)/sd(trend_GDP),sd(trend_I)/sd(trend_GDP), sd(trend_C)/sd(trend_GDP),sd(trend_G)/sd(trend_GDP)),
  cont_output_corr = c(cor(trend_GDP,trend_GDP), cor(trend_I,trend_GDP), cor(trend_C,trend_GDP), cor(trend_G,trend_GDP))
    )
output_table
```
### Window 1
```{r}
GDP_W1 <- window(GDP, end=2007.75)
I_W1 <- window(I, end=2007.75)
C_W1 <- window(C, end=2007.75)
G_W1 <- window(G, end=2007.75)

trend_G <- hpfilter(log(G_W1))[1]$cycle
trend_C <- hpfilter(log(C_W1))[1]$cycle
trend_I <- hpfilter(log(I_W1))[1]$cycle
trend_GDP <- hpfilter(log(GDP_W1))[1]$cycle

output_table_W1 <- data.frame(
  names = c("GDP","I","C","G"),
  standard_deviation = c(sd(trend_GDP),sd(trend_I),sd(trend_C),sd(trend_G)),
  relative_sd = c(sd(trend_GDP)/sd(trend_GDP),sd(trend_I)/sd(trend_GDP), sd(trend_C)/sd(trend_GDP),sd(trend_G)/sd(trend_GDP)),
  cont_output_corr = c(cor(trend_GDP,trend_GDP), cor(trend_I,trend_GDP), cor(trend_C,trend_GDP), cor(trend_G,trend_GDP))
  )
```


### Window 2
```{r}
GDP_W2 <- window(GDP, start=2008.0)
I_W2 <- window(I, start=2008.0)
C_W2 <- window(C, start=2008.0)
G_W2 <- window(G, start=2008.0)

trend_G <- hpfilter(log(G_W2))[1]$cycle
trend_C <- hpfilter(log(C_W2))[1]$cycle
trend_I <- hpfilter(log(I_W2))[1]$cycle
trend_GDP <- hpfilter(log(GDP_W2))[1]$cycle

output_table_W2 <- data.frame(
  names = c("GDP","I","C","G"),
  standard_deviation = c(sd(trend_GDP),sd(trend_I),sd(trend_C),sd(trend_G)),
  relative_sd = c(sd(trend_GDP)/sd(trend_GDP),sd(trend_I)/sd(trend_GDP), sd(trend_C)/sd(trend_GDP),sd(trend_G)/sd(trend_GDP)),
  cont_output_corr = c(cor(trend_GDP,trend_GDP), cor(trend_I,trend_GDP), cor(trend_C,trend_GDP), cor(trend_G,trend_GDP))
    )
```

### Output
```{r}
output_table
output_table_W1
output_table_W2
```